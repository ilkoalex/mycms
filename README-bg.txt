Система за управление на съдържанието създадена от Ваньо Георгиев http://vanyog.com.
Започната през декември 2010 г.

Този README.txt файл съдържа кратко общо описание на системата и към момента е съществена част от документация по нея.
Указания за ползване на системата ще намерите във файл USEAGE.txt.

ИДЕИ ЗА ГЛАВНИТЕ ВЪЗМОЖНОСТИ НА СИСТЕМАТА

- позволява поддържане на многоезични сайтове
- редактирането на всички файлове и данни на сайта се извършва само с помощта на Интернет браузър, редакторът, който се използва за тази цел, показва първичен код, но има възможност да се ползва и WYSIWYG редактор, например CKEditor
- дава пълна свобода за съставяне на съдържанието на страниците, системата е отворена и позволява добавяне на скриптове за генериране на произволно сложно специализирано съдържание
- модулен характер - състои се от главна библиотека в директория lib и независими модули, всеки в собствена директория
- кои HTML и CSS стандарти ще се спазват е избор на разработчика и не се налагат от самата система  
- системата е ориентирана повече към улесняване работата на php програмиста, създаващ сайт, но и с намерение да се направи лесна за използване и от собственици на сайтове, желаещи сами да поддържат съдържанието им
- позволява лесно сравняване на всяка страница от две копия на сайта - работещо онлайн копие и локално копие, както и бързо прехвърляне на съдържание от едното към другото копие
- позволява инсталиране на работещ сайт и постепенно пренасяне на съдържанието му в новата система

ИЗИСКВАНИЯ ЗА СЪРВЪРА

Посочените версии са тези, на които аз работя по системата, но е вероятно, че тя би могла да работи и на по-ниски версии.

Apache версия 2.2.12 или следваща
MySQL версия от 5.1.37 или следваща
PHP версия от 5.3.0 или следваща

КРАТКО ОПИСАНИЕ

Шаблони

Съдържанието на всички страници се съхранява в базата данни и се генерира с помощта на шаблони и скриптове за генериране на html код.

Шаблоните се съхраняват в таблицата от базата данни $tn_prefix.'templates'. ($tn_prefix е представка към имената на таблиците в базата данни, задава се във файл conf_database.php.) 

Шаблонът представлява html код с вмъкнати в него елементи от вида: <!--$$_XXXX_$$-->, където XXXX са различни имена. Тези елементи при генериране на страница се заместят с друг html код. Замяната се извършва от скрипта index.php чрез извикване на функцията parse_template() (от файл f_parse_template.php), която от своя страна извиква parse_content() от файл f_parse_content.php.

Един шаблон може да бъде наследник на друг шаблон, т.е. да се вмъква в него. В кой друг шаблон трябва да се вмъкне даден шаблон се посочва в полето parent на записа му в таблица $tn_prefix.'templates'. Ако това поле е нула шаблонът не се вмъква в друг шаблон. Мястото в което се вмъква шаблон наследник се означава с <!--$$_TEMPLATE_$$-->. Вмъкването на шаблоните се извършва от функцията parse_template() преди да започне вмъкването на друго съдържание с parse_content().

Настройки

Настройките, с изключение на тези за достъп до базата занни, се съхраняват в таблица $tn_prefix.'options' и съответно се четат и запосват с функциите stored_value($n) и store_value($n,$v) от файл lib/f_stored_value.php.

Текстове

Всички показвани на страниците надписи и текстове се съхраняват в таблицата $tn_prefix.'content' и могат да бъдат на различни езици. Езиците, на които се показва съдържание се задават в настройката languages. Всеки текст или надпис се идентифицира с име, което е еднакво за преводите на този текст на всички езици. Надпис се показва с функцията translate($n) (дефинирана във файл f_translate.php), в която $n е името на надписа. Вижте повече в коментарите във файл f_translate.php.

В текстовете, също както и в шаблоните, може да има <!--$$_XXXX_$$--> елементи за заместване, които се генерират от различни php функции. Заместването на тези елементи се извършва от функцията parse_content(), дефинирана във файл f_parse_content.php, а самата тя се извиква от функцията translate() след извличане на даден превод на текст от таблицата $tn_prefix.'content'.

Скриптове

Скриптовете за генериране на html код, който трябва да замества елементите от вида <!--$$_XXXX_$$--> се съхраняват в таблица $tn_prefix.'scripts' и се четат от там само ако са необходими. Изпълняват се с функцията eval(). 

УГОВОРКИ

Директорията $adm_pth, зададена във файл conf_paths.php, съдържа скриптове за администриране на системата и трябва да е защитена с парола.

Имената XXXX на елементите, подлежащи на заместване в шаблоните и в текстовете на страниците се изписват само с главни букви. Имената може да се състоят от две части, отделени с _. В такъв случай втората част е параметър, който се предава на функцията, генерираща съответното съдържание.

ПРЕФИКСИ В ИМЕНАТА НА ФАЙЛОВЕТЕ:

conf_  - файлове съдържащи настройки
f_     - файлове дефиниращи функции
f_db_  - файлове дефиниращи функции за извличане на информация от базата данни

ТАБЛИЦИ В БАЗАТА ДАННИ

Във всички таблици има поле с име ID и опции pimary index и auto_increment, затова това поле няма да се споменава в описанието на таблиците. Полето представлява автоматично поставян, уникален номер на записа в таблицата.

$tn_prefix.'templates' - съхранява шаблоните за генериране на страници
----------------------
Полета:
parent - родител на шаблона. Използва се, когато шаблонът трябва да се вмъкне в друг шаблон, за да оформи страница.
template - html код на шаблона.

$tn_prefix.'content' - съхранява текстове, преведени на различни езици.
--------------------
Полета:
name - име на текста
date_time_1 - дата и час на първото му въвеждане
date_time_2 - дата и час на последната му редакция
language - двубуквено означение на езика, например: 'bg','en' и т.н.
text - текст

$tn_prefix.'pages' - съхранява информация как да се генерира всяка страница
------------------
Полета:
menu_group - номер на групата хипервръзки, които се показват като меню заедно със страницата
title - име на заглавието на страницата, което се взема от таблица $tn_prefix.'content'
content - име на съдържанието на страницата, взема се от таблица $tn_prefix.'content'
template_id - номер на шаблона, по който се съставя страницата, взема се от таблица $tn_prefix.'templates'
hidden - логическо поле, което ако е истина означава, че страницата не трябва да се показва в навигацията на сайта
options - поле, което съдържа флагове, използвани за предаване на информация към различни функции за генериране на съдържание, например, размери на google реклами
dcount - брой показвания на страницата през денонощието
tcount - общ брой показвания на страницата от момента на пускането й

$tn_prefix.'scripts' - съхранява скриптове, които се извличат и се изпълняват с eval(), за да генерират html код за заместване на <!--$$_XXXX_$$--> елементите
-----------------------
Полета:
name - име, което съвпада с XXXX името
script - php код
coment - текстово описание на скрипта (нещо като help)

$tn_prefix.'menu_items' - съхранява информация за съставяне на менюта от хипервръзки
-----------------------
Полета:
place - числа, задаващи реда на подреждане на хипервръзките в менюто
group - номер на менюто, към което принадлежи хипервръзката
name - име на текста, с който се показва хипервръзката
link - url, към който сочи хипервръзката

$tn_prefix.'menu_trees'. Предвидено е менютата да образуват дървовидна структура и някои менюта да са "деца" на други менюта. Тази таблица се посочва родителското меню на всяко меню "дете". 
-----------------------
Полета:
group - номер на менюто (групата хипервръзки)
parent - номер на родителя на менюто
index_page - номер (ID) на страница от таблица $tn_prefix.'pages', която се явява главна страница на менюто

Инструкции за използване на системата на български ще намерите във файл USAGE.txt.

ЗА ПОВЕЧЕ ИНФОРМАЦИЯ разгледайте коментарите в php файловете.

За контакт с автора посетете сайта vanyog.com.

Системата може да изтеглите от адрес: http://vanyog.com/_new/index.php?pid=30.



