Модул за контрол на достъпа на потребители
==========================================

Изисква модул usermenu

В html кода на страница, до която трябва да имат достъп само регистрирани потребители, се въвежда:

<!--$$_USER[_xxx]_$$-->

Ако в $_SESSION не се съхраняват валидно потребителско име и парола се показва форма за влизане. Въведените с тази форма потребителско име и парола се съхраняват в $_SESSION и страницата се презарежда за нова проверка. Ако запазените в $_SESSION потребителско име и парола не са валидни, те се изтриват и се генерира Access denied. След успешно влизане на мястото на елемента <!--$$_USER[_xxx]_$$--> се показва потребителското име на потребителя и хипервръзка "Изход".

Модулът получава параметри за промяна на своето действие по два начина:

1. с незадължителния параметър ххх.
Ако ххх е 'edit' - на мястото на елемента се показва форма за редактиране данните на потребителя.
Ако ххх е 'login' - на мястото на елемента се показва форма за влизане с име и парола. Задаването на този параметър вместо неговото пропускане има ефект, че страницата за влизане се генерира както всички останали страници с помощта на шаблони от базата данни. Ако не се зададе параметър login формата за влизане се показва в отделна, съвсем празна страница, която се генерира с /lib/build_page.php.
Ако ххх е 'enter' - ако няма влязъл потребител се показва хипервръзка "Вход". Използва се за поставяне върху общодостъпни страници за посочване страницата за влизане на регистрирани потребители.

2. с параметър user в адреса на страницата
Ако user=logout се предизвиква излизане на потребителя.
Ако user=newreg се показва форма за създаване на нов потребител.
Ако user=enter се проверява дали има влязъл потребител и ако няма, се показва форма за влизане, след което страницата се презарежда.

Настройки в таблица $tn_prefix.'options'

user_loginpage - Страница, на която се отива след влизане на потребителя.
user_logoutpage - Страница, на която се отива след излизане на потребителя.
user_mysqlpass = yes - задава за кодиране на паролите да се използва функцията password() на MySQS вместо php функцията sha1().
user_table - име на таблица с данни за потребителите без префикса $tn_prefix
user_types - Отделени със запетая имена на алтернативни функции за проверка на потребителското име и паролата.

